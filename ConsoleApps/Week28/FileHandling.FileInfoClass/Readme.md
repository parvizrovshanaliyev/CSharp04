# 📁 File Handling in C# – `FileInfo` Class (Comprehensive Beginner’s Guide)

Welcome to the ultimate beginner-friendly guide to working with the `FileInfo` class in C#.
Whether you're just getting started with file handling or want to understand the difference between `File` and `FileInfo`,
this guide will walk you through everything you need — with **real-world examples**, **best practices**, and detailed comparisons.

---

## 🎯 Who Should Read This?
This guide is intended for:
- **Students and beginner developers** learning about file I/O in C#
- Anyone exploring **object-oriented approaches** to file handling
- Developers confused about when to use `File` versus `FileInfo`

No prior experience with file handling is required — this guide starts from the fundamentals.

---

## 📘 What Is File Handling?
**File handling** is the ability of your application to read, write, copy, delete, or inspect files stored on a file system. These are critical operations for building:
- Logging systems
- Data import/export tools
- File-based configuration managers
- Content manipulation or file-based workflows

The C# file handling system lives within the `System.IO` namespace:
```csharp
using System.IO;
```

This namespace provides two main options for handling files:
- `File` – A static class for quick operations
- `FileInfo` – An object-oriented class with metadata caching

---

## 📂 What Is `FileInfo`?

The `FileInfo` class provides an **object-oriented**, instance-based interface to interact with files. It is especially useful when you:
- Access a file repeatedly (e.g., reading properties and writing data)
- Need metadata like size, creation time, or last modified date
- Want a maintainable and reusable file interface in larger applications

### 🔍 Key Properties
| Property          | Description                              |
|------------------|------------------------------------------|
| `Length`         | File size in bytes                       |
| `Name`           | File name only (e.g., "log.txt")         |
| `Extension`      | File extension (e.g., ".txt")            |
| `DirectoryName`  | Full path of the parent directory        |
| `CreationTime`   | Date and time the file was created       |
| `LastWriteTime`  | Last modified date and time              |

### 🛠️ Common Methods
| Method            | Use Case                                  |
|------------------|-------------------------------------------|
| `Create()`        | Create a file and return a stream         |
| `Delete()`        | Delete the file permanently               |
| `CopyTo()`        | Copy file to another location             |
| `MoveTo()`        | Move file to a new location               |
| `OpenRead()`      | Open a read-only file stream              |
| `OpenWrite()`     | Open a writable file stream               |
| `Refresh()`       | Refresh cached metadata                  |

---

## ⚙️ File vs FileInfo – Key Differences & When to Use

| Feature                       | `File` (Static Class)                 | `FileInfo` (Instance-Based Class)          |
|------------------------------|---------------------------------------|---------------------------------------------|
| API Style                    | Functional / Utility-based            | Object-oriented                             |
| Performance                  | Re-evaluates path on every operation  | Caches file info for reuse                  |
| Metadata Support             | Minimal (requires manual extraction)  | Built-in rich metadata                      |
| Best Use Case                | One-off quick tasks (e.g., copy file) | Repeated access or metadata-heavy logic     |
| Integration                  | Quick scripts, config tools           | Larger, maintainable projects               |

✅ Use `File` for:
- One-time actions (e.g., delete a file, read all text)
- Small scripts or setup utilities

✅ Use `FileInfo` for:
- Repeated access to the same file
- Managing logs, processing large file sets
- Clean, OOP-based application logic

---

## 🧪 Hands-On Code Examples

### 🔹 Instantiating `FileInfo`
```csharp
var fileInfo = new FileInfo("report.txt");
```

### 🔹 Creating and Writing to a File
```csharp
if (!fileInfo.Exists)
{
    using (var writer = fileInfo.CreateText())
    {
        writer.WriteLine("Generated by FileInfo");
    }
}
```

### 🔹 Reading File Metadata
```csharp
Console.WriteLine($"File Name: {fileInfo.Name}");
Console.WriteLine($"Size: {fileInfo.Length} bytes");
Console.WriteLine($"Created At: {fileInfo.CreationTime}");
Console.WriteLine($"Last Modified: {fileInfo.LastWriteTime}");
```

### 🔹 Copying and Moving Files
```csharp
fileInfo.CopyTo("backup/report.txt", overwrite: true);
fileInfo.MoveTo("archive/report.txt");
```

### 🔹 Deleting a File Safely
```csharp
if (fileInfo.Exists)
{
    fileInfo.Delete();
    Console.WriteLine("File deleted successfully.");
}
```

### 🔹 Refreshing Metadata After External Change
```csharp
fileInfo.Refresh();
Console.WriteLine($"Updated Last Modified: {fileInfo.LastWriteTime}");
```

---

## 🧼 Best Practices for FileInfo

✅ Always check `fileInfo.Exists` before attempting operations.  
✅ Wrap all file I/O operations in `try-catch` blocks.  
✅ Use `using` blocks for file streams to ensure resources are released.  
✅ Call `Refresh()` if you suspect the file has been modified externally.  
✅ Avoid hardcoding file paths — use `Path.Combine()` for cross-platform safety.

```csharp
var path = Path.Combine(Environment.CurrentDirectory, "data", "report.txt");
var fileInfo = new FileInfo(path);
```

---

## ⚠️ Common Pitfalls
- ❌ **Accessing non-existent files without checking `Exists`**
- ❌ **Forgetting to dispose file streams**, leading to locked files
- ❌ **Not calling `Refresh()`** when expecting up-to-date metadata
- ❌ **Using `FileInfo` for one-liners when `File` would be simpler**
- ❌ **Not catching exceptions such as `UnauthorizedAccessException`**

---

## 📚 Further Learning Resources
- [📄 FileInfo Class Documentation – Microsoft](https://learn.microsoft.com/en-us/dotnet/api/system.io.fileinfo)
- [📘 C# File I/O – Microsoft Learn Module](https://learn.microsoft.com/en-us/training/modules/work-with-files/)
- [🎥 YouTube: FileInfo vs File – Practical Comparisons](https://www.youtube.com/results?search_query=fileinfo+vs+file+c%23)

---

## ✅ Final Thoughts
The `FileInfo` class brings a clean, object-oriented approach to file handling in C#. It’s particularly powerful in scenarios where file metadata is frequently accessed or multiple operations are required on the same file. Compared to the `File` class, it promotes better encapsulation and performance for repeat access.

> 🔧 **Mini Project Idea:** Build a directory inspector CLI that uses `FileInfo` to display file sizes, types, and modification dates — optionally sort them by size.

Happy coding! 🚀






